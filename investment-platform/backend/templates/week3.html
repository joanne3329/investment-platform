{% extends "base.html" %}
{% block content %}
<div class="container mt-5 text-center">
  <h2>{{ title }}</h2>
  <p class="mt-3">這裡是 Week3：股票分析與策略（本地 Hugging Face 模型：GPT2 Medium）</p>

  <!-- LLM 互動區 -->
  <div class="mt-4 p-3 border rounded">
    <h4>💡 問問題，獲得即時回饋</h4>
    <textarea id="userInput" rows="4" class="form-control" placeholder="輸入你的問題..."></textarea>
    <button class="btn btn-primary mt-2" onclick="askLLM()">送出</button>
    <pre id="reply" class="text-start mt-3"></pre>
  </div>

  <a href="/map" class="btn btn-secondary mt-4">返回學習地圖</a>
</div>

<script>
async function askLLM() {
  const query = document.getElementById("userInput").value;
  document.getElementById("reply").innerText = "思考中...";

  const res = await fetch("/ask", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ query })
  });

  const data = await res.json();
  document.getElementById("reply").innerText = data.answer;
}
</script>
{% endblock %}
